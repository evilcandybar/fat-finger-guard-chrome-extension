!function(){"use strict";new class{constructor(){this.COLLECTION_BID_FLOOR_PRICE_IDENTIFIER="sc-iJKOTD jfsUuI",this.SELL_ITEM_FLOOR_PRICE_IDENTIFIER="sc-iJKOTD cDyuof",this.floorPriceElement=void 0,this.floorPriceIdentifier=void 0,this.isPorfolioPage=!1,this.priceBoxDiscoveryInterval=void 0,this.floorPrice=void 0,this.aboveThresholdPercentage=50,this.belowThresholdPercentage=50,this.currentUrl="",this.setup()}async setup(){chrome.storage.sync.get("blurBelowInput",(e=>{e.blurBelowInput&&(this.belowThresholdPercentage=e.blurBelowInput)})),chrome.storage.sync.get("blurAboveInput",(e=>{e.blurAboveInput&&(this.aboveThresholdPercentage=e.blurAboveInput)})),chrome.runtime.onMessage.addListener(((e,t,i)=>{"setBlurAboveInput"===e.message&&(this.aboveThresholdPercentage=e.value),"setBlurBelowInput"===e.message&&(this.belowThresholdPercentage=e.value)})),this.currentUrl=window.location.href,this.setIdentifiers(),this.setupPriceBoxDiscovery()}setIdentifiers(){var e,t;this.currentUrl=window.location.href,this.isPorfolioPage=!1,(null===(e=this.currentUrl)||void 0===e?void 0:e.includes("/portfolio"))?(this.isPorfolioPage=!0,this.floorPriceIdentifier=this.SELL_ITEM_FLOOR_PRICE_IDENTIFIER):(null===(t=this.currentUrl)||void 0===t?void 0:t.includes("/bids"))&&(this.floorPriceIdentifier=this.COLLECTION_BID_FLOOR_PRICE_IDENTIFIER)}setupPriceBoxDiscovery(){this.priceBoxDiscoveryInterval=setInterval((()=>{let e=document.getElementsByClassName(this.floorPriceIdentifier);this.floorPriceElement&&0==e.length&&(this.floorPriceElement=void 0),e.length>0?this.attachElementEventListeners(e[0]):this.setIdentifiers()}),500)}attachElementEventListeners(e){if(this.currentUrl!=window.location.href)return void this.setIdentifiers();this.floorPriceElement=e;let t=this.floorPriceElement.innerText;try{this.floorPrice=+t,this.isPorfolioPage?this.handlePortfolioPageWarnings():this.handleBidPageWarnings()}catch(e){console.log(e)}}handlePortfolioPageWarnings(){var e,t,i,r,n;const o=Array.from(document.querySelectorAll('[role="columnheader"]')).find((e=>"PROCEEDS"===e.innerText));[...(o&&null!==(n=null===(r=null===(i=null===(t=null===(e=o.parentElement)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.children[1])||void 0===i?void 0:i.firstChild)||void 0===r?void 0:r.firstChild)&&void 0!==n?n:[]).children].forEach((e=>{var t;let i=[...e.children][e.children.length-1];const r="#text"==i.lastChild.nodeName?i.lastChild:Array.from(null===(t=i.lastChild)||void 0===t?void 0:t.children).find((e=>"INPUT"==e.tagName)),n=new MutationObserver(((e,t)=>{var n,o,l,s;if("fat-finger-warning"==i.parentElement.lastChild.id){i.parentElement.removeChild(i.parentElement.lastChild),i.lastChild.style="";const e=null===(o=null===(n=Array.from(document.querySelectorAll('[transform="uppercase"]')).find((e=>"DURATION"===e.innerText)))||void 0===n?void 0:n.parentElement)||void 0===o?void 0:o.parentElement,t=document.getElementById("fat-finger-confirm-btn");e&&t&&e.removeChild(t)}const a=Number(r.value);if(!Number.isNaN(a)&&0!=+a&&this.isPriceOverThreshhold(a)){i.lastChild.style="border: 2px solid #ea4711";const e=`POTENTIAL FAT FINGER > ${this.getBreachedThresholdPercentage(a)}% ${this.isPositiveThreshold(Number(i.lastChild.firstChild.value))?"above":"below"} floor`,t=document.createElement("div");if(t.innerText=e,t.id="fat-finger-warning",t.style="position: fixed;z-index: 999999;width: 100%;height: 13px;background: #ea4711;top: 35px;left: 1px;font-size: 12px;padding-right: 8px;letter-spacing: -1px;font-weight: 900;color: black;text-align: right;font-family: 'Proto Mono';",i.parentElement.appendChild(t),!document.getElementById("fat-finger-confirm-btn")){const e=null===(s=null===(l=Array.from(document.querySelectorAll('[transform="uppercase"]')).find((e=>"DURATION"===e.innerText)))||void 0===l?void 0:l.parentElement)||void 0===s?void 0:s.parentElement,t=e.lastChild.cloneNode(!0);t.style="font-family: 'Proto Mono';position: fixed;width: 200px;opacity: 1;padding-top: 2px;cursor: pointer;text-transform: uppercase;",t.firstChild.style="line-height: 13px;",t.id="fat-finger-confirm-btn",t.innerText="confirm fat finger check",t.disabled=!1,t.addEventListener("click",(e=>{t.parentElement.removeChild(e.target)})),e.appendChild(t)}}}));n.observe(r,{attributes:!0,attributeFilter:["value"]})}))}handleBidPageWarnings(){const e=Array.from(document.querySelectorAll('[transform="uppercase"]')).find((e=>"BID PRICE"===e.innerText));if(e){const t=e.parentElement.lastChild.firstChild.firstChild;t.addEventListener("input",(e=>{var i,r,n,o;if("fat-finger-warning"==t.parentElement.lastChild.id){t.parentElement.removeChild(t.parentElement.lastChild),t.style="";const e=null===(r=null===(i=Array.from(document.querySelectorAll('[transform="uppercase"]')).find((e=>"DURATION"===e.innerText)))||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.parentElement,n=document.getElementById("fat-finger-confirm-btn");e&&n&&e.removeChild(n)}const l=Number(t.value);if(!Number.isNaN(l)&&0!=+l&&this.isPriceOverThreshhold(l)){t.style="border: 2px solid #ea4711";const e=`POTENTIAL FAT FINGER > ${this.getBreachedThresholdPercentage(l)}% ${this.isPositiveThreshold(Number(t.value))?"above":"below"} floor`,i=document.createElement("div");if(i.innerText=e,i.id="fat-finger-warning",i.style='position: absolute;z-index: 999999;width: 100%;height: 13px;background: rgb(234, 71, 17);bottom: 91px;left: 1px;font-size: 12px;padding-right: 8px;letter-spacing: -1px;font-weight: 900;color: black;text-align: right;font-family: "Proto Mono"',t.parentElement.appendChild(i),!document.getElementById("fat-finger-confirm-btn")){const e=null===(o=null===(n=Array.from(document.querySelectorAll('[transform="uppercase"]')).find((e=>e.innerText.includes("PLACE BID"))))||void 0===n?void 0:n.parentElement)||void 0===o?void 0:o.parentElement,t=e.lastChild.cloneNode(!0);t.style='display: flex;min-width: 200px;align-items: center;justify-content: space-between;opacity: 1;position: fixed;z-index: 2; cursor: pointer; text-align: center;font-family: "Proto Mono"; font-size: 12px; text-transform: uppercase',t.removeChild(t.lastChild),t.id="fat-finger-confirm-btn",t.innerText="confirm fat finger check",t.disabled=!1,t.addEventListener("click",(e=>{t.parentElement.removeChild(e.target)})),e.appendChild(t)}}}))}}isPriceOverThreshhold(e){const t=(e-this.floorPrice)/this.floorPrice*100;return t>=this.aboveThresholdPercentage||t<=-this.belowThresholdPercentage}getBreachedThresholdPercentage(e){const t=e-this.floorPrice;return Math.abs(Math.round(t/this.floorPrice*100))}isPositiveThreshold(e){return e-this.floorPrice>0}}}();
